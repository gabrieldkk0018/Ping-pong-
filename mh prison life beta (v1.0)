-- MH Prison Life v1 (beta)
-- carregado com sucesso!
-- by: Miel

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")

--================ ORION =================--

local OrionLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/shlexware/Orion/main/source"))()

local Window = OrionLib:MakeWindow({
	Name = "MH Prison Life v1 (beta)",
	HidePremium = true,
	SaveConfig = false,
	ConfigFolder = "MHPrisonLife"
})

--================ FLAGS =================--

local FPSBoost = false
local ESPEnabled = false
local ESPWall = true

local AimbotEnabled = false
local AimFOV = 180
local AimSmooth = 0.25

local AimInmates = false
local AimCriminals = true
local AimGuards = false

--================ FPS BOOST =================--

local function EnableFPS()
	for _,v in pairs(Lighting:GetChildren()) do
		if v:IsA("PostEffect") then
			v.Enabled = false
		end
	end
	Lighting.GlobalShadows = false
	settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
end

--================ ESP =================--

local ESPFolder = Instance.new("Folder", game.CoreGui)
ESPFolder.Name = "MH_ESP"

local function ClearESP()
	ESPFolder:ClearAllChildren()
end

local function CreateESP(plr)
	if plr == LocalPlayer then return end
	if not plr.Character or not plr.Character:FindFirstChild("HumanoidRootPart") then return end

	local hl = Instance.new("Highlight")
	hl.Adornee = plr.Character
	hl.OutlineTransparency = 1
	hl.DepthMode = ESPWall and Enum.HighlightDepthMode.AlwaysOnTop or Enum.HighlightDepthMode.Occluded

	if plr.Team and plr.Team.Name == "Guards" then
		hl.FillColor = Color3.fromRGB(0,150,255)
	else
		hl.FillColor = Color3.fromRGB(255,60,60)
	end

	hl.Parent = ESPFolder
end

local function RefreshESP()
	ClearESP()
	if not ESPEnabled then return end
	for _,p in pairs(Players:GetPlayers()) do
		CreateESP(p)
	end
end

Players.PlayerAdded:Connect(function(plr)
	plr.CharacterAdded:Connect(function()
		task.wait(0.5)
		if ESPEnabled then
			CreateESP(plr)
		end
	end)
end)

--================ AIMBOT =================--

local function ValidTarget(plr)
	if not plr.Team then return false end
	if plr.Team.Name == "Inmates" and AimInmates then return true end
	if plr.Team.Name == "Criminals" and AimCriminals then return true end
	if plr.Team.Name == "Guards" and AimGuards then return true end
	return false
end

local function GetClosest()
	local closest, dist = nil, math.huge
	for _,p in pairs(Players:GetPlayers()) do
		if p ~= LocalPlayer
		and ValidTarget(p)
		and p.Character
		and p.Character:FindFirstChild("HumanoidRootPart")
		and p.Character:FindFirstChild("Humanoid")
		and p.Character.Humanoid.Health > 0 then

			local d = (Camera.CFrame.Position - p.Character.HumanoidRootPart.Position).Magnitude
			if d < AimFOV and d < dist then
				dist = d
				closest = p
			end
		end
	end
	return closest
end

RunService.RenderStepped:Connect(function()
	if AimbotEnabled then
		local t = GetClosest()
		if t and t.Character then
			Camera.CFrame = Camera.CFrame:Lerp(
				CFrame.new(Camera.CFrame.Position, t.Character.HumanoidRootPart.Position),
				AimSmooth
			)
		end
	end
end)

--================ UI =================--

local MainTab = Window:MakeTab({
	Name = "Main",
	Icon = "rbxassetid://4483345998",
	PremiumOnly = false
})

MainTab:AddToggle({
	Name = "FPS Boost",
	Default = true,
	Callback = function(v)
		FPSBoost = v
		if v then EnableFPS() end
	end
})

MainTab:AddToggle({
	Name = "ESP",
	Default = false,
	Callback = function(v)
		ESPEnabled = v
		RefreshESP()
	end
})

MainTab:AddToggle({
	Name = "ESP atravÃ©s das paredes",
	Default = true,
	Callback = function(v)
		ESPWall = v
		RefreshESP()
	end
})

MainTab:AddToggle({
	Name = "Aimbot",
	Default = false,
	Callback = function(v)
		AimbotEnabled = v
	end
})

MainTab:AddSlider({
	Name = "Aimbot Alcance",
	Min = 50,
	Max = 350,
	Default = 180,
	Callback = function(v)
		AimFOV = v
	end
})

MainTab:AddSlider({
	Name = "Aimbot Smooth",
	Min = 0.05,
	Max = 0.5,
	Default = 0.25,
	Callback = function(v)
		AimSmooth = v
	end
})

local TeamTab = Window:MakeTab({
	Name = "Aimbot Team",
	Icon = "rbxassetid://4483345998"
})

TeamTab:AddToggle({
	Name = "Mirar Inmates",
	Default = false,
	Callback = function(v)
		AimInmates = v
	end
})

TeamTab:AddToggle({
	Name = "Mirar Criminals",
	Default = true,
	Callback = function(v)
		AimCriminals = v
	end
})

TeamTab:AddToggle({
	Name = "Mirar Guards",
	Default = false,
	Callback = function(v)
		AimGuards = v
	end
})

OrionLib:Init()
