--==================================================
-- MH PRISON HUB v1 (MOBILE ONLY)
-- FPS BOOST | ESP | AIMBOT
--==================================================

-- SERVICES
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Lighting = game:GetService("Lighting")

-- CLEAN
if game.CoreGui:FindFirstChild("MH_Prison_Hub") then
	game.CoreGui.MH_Prison_Hub:Destroy()
end

--==================================================
-- UI
--==================================================

local Gui = Instance.new("ScreenGui", game.CoreGui)
Gui.Name = "MH_Prison_Hub"
Gui.ResetOnSpawn = false

local Main = Instance.new("Frame", Gui)
Main.Size = UDim2.new(0,260,0,200)
Main.Position = UDim2.new(1,-280,0,200)
Main.BackgroundColor3 = Color3.fromRGB(30,30,40)
Main.BorderSizePixel = 0
Main.ClipsDescendants = true
Instance.new("UICorner",Main).CornerRadius = UDim.new(0,12)

-- RGB border
local Stroke = Instance.new("UIStroke",Main)
Stroke.Thickness = 2
Stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
RunService.RenderStepped:Connect(function()
	Stroke.Color = Color3.fromHSV((tick()%5)/5,1,1)
end)

-- TOP BAR
local Top = Instance.new("TextButton",Main)
Top.Size = UDim2.new(1,0,0,36)
Top.Text = "MH Prison Hub"
Top.Font = Enum.Font.GothamBold
Top.TextSize = 14
Top.TextColor3 = Color3.fromRGB(255,255,255)
Top.BackgroundColor3 = Color3.fromRGB(40,40,55)
Top.AutoButtonColor = false

local MinBtn = Instance.new("TextButton",Top)
MinBtn.Size = UDim2.new(0,30,1,0)
MinBtn.Position = UDim2.new(1,-32,0,0)
MinBtn.Text = "-"
MinBtn.Font = Enum.Font.GothamBold
MinBtn.TextSize = 18
MinBtn.BackgroundTransparency = 1
MinBtn.TextColor3 = Color3.fromRGB(255,255,255)

-- CONTENT
local Content = Instance.new("Frame",Main)
Content.Position = UDim2.new(0,0,0,36)
Content.Size = UDim2.new(1,0,1,-36)
Content.BackgroundTransparency = 1

local function makeButton(text,y)
	local b = Instance.new("TextButton",Content)
	b.Size = UDim2.new(1,-20,0,36)
	b.Position = UDim2.new(0,10,0,y)
	b.BackgroundColor3 = Color3.fromRGB(45,45,65)
	b.TextColor3 = Color3.fromRGB(255,255,255)
	b.Font = Enum.Font.GothamBold
	b.TextSize = 13
	b.Text = text..": OFF"
	Instance.new("UICorner",b).CornerRadius = UDim.new(0,8)
	return b
end

local FPSBtn = makeButton("FPS Boost",10)
local ESPBtn = makeButton("ESP",56)
local AIMBtn = makeButton("Aimbot",102)

--==================================================
-- DRAG MOBILE ONLY
--==================================================

do
	local dragging = false
	local dragStart, startPos

	Top.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.Touch then
			dragging = true
			dragStart = input.Position
			startPos = Main.Position
		end
	end)

	Top.InputEnded:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.Touch then
			dragging = false
		end
	end)

	UserInputService.InputChanged:Connect(function(input)
		if dragging and input.UserInputType == Enum.UserInputType.Touch then
			local delta = input.Position - dragStart
			Main.Position = UDim2.new(
				startPos.X.Scale,
				startPos.X.Offset + delta.X,
				startPos.Y.Scale,
				startPos.Y.Offset + delta.Y
			)
		end
	end)
end

--==================================================
-- MINIMIZE (SEM BUG)
--==================================================

local minimized = false
local openSize = UDim2.new(0,260,0,200)
local miniSize = UDim2.new(0,260,0,36)

MinBtn.MouseButton1Click:Connect(function()
	minimized = not minimized
	if minimized then
		Content.Visible = false
		MinBtn.Text = "+"
		TweenService:Create(Main,TweenInfo.new(0.25),{Size=miniSize}):Play()
	else
		MinBtn.Text = "-"
		TweenService:Create(Main,TweenInfo.new(0.25),{Size=openSize}):Play()
		task.wait(0.15)
		Content.Visible = true
	end
end)

--==================================================
-- FPS BOOST
--==================================================

local FPS_ON = false
local function FPSBoost(state)
	FPS_ON = state
	if state then
		Lighting.GlobalShadows = false
		Lighting.FogEnd = 1e9
		pcall(function()
			settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
		end)
	end
	FPSBtn.Text = "FPS Boost: "..(state and "ON" or "OFF")
end

FPSBtn.MouseButton1Click:Connect(function()
	FPSBoost(not FPS_ON)
end)

--==================================================
-- ESP (PRISON LIFE) - WALLHACK
--==================================================

local ESP_ON = false
local ESPFolder = Instance.new("Folder",Gui)

local function applyESP(plr)
	if plr == LocalPlayer then return end
	if not plr.Character or not plr.Character:FindFirstChild("HumanoidRootPart") then return end

	local hl = Instance.new("Highlight")
	hl.Adornee = plr.Character
	hl.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
	hl.OutlineTransparency = 1

	if plr.Team and plr.Team.Name == "Guards" then
		hl.FillColor = Color3.fromRGB(0,170,255)
	else
		hl.FillColor = Color3.fromRGB(255,80,80)
	end

	hl.Parent = ESPFolder
end

local function RefreshESP()
	ESPFolder:ClearAllChildren()
	if not ESP_ON then return end
	for _,p in pairs(Players:GetPlayers()) do
		applyESP(p)
	end
end

ESPBtn.MouseButton1Click:Connect(function()
	ESP_ON = not ESP_ON
	ESPBtn.Text = "ESP: "..(ESP_ON and "ON" or "OFF")
	RefreshESP()
end)

Players.PlayerAdded:Connect(RefreshESP)
Players.PlayerRemoving:Connect(RefreshESP)

--==================================================
-- AIMBOT MOBILE (AUTO)
--==================================================

local AIM_ON = false
local FOV = 140
local SMOOTH = 0.1

local function getMobileTarget()
	local closest
	local shortest = math.huge

	for _,p in pairs(Players:GetPlayers()) do
		if p ~= LocalPlayer
		and p.Team ~= LocalPlayer.Team
		and p.Character
		and p.Character:FindFirstChild("HumanoidRootPart")
		and p.Character:FindFirstChild("Humanoid")
		and p.Character.Humanoid.Health > 0 then

			local root = p.Character.HumanoidRootPart
			local dist = (root.Position - Camera.CFrame.Position).Magnitude

			if dist < FOV and dist < shortest then
				shortest = dist
				closest = p
			end
		end
	end

	return closest
end

RunService.RenderStepped:Connect(function()
	if AIM_ON then
		local target = getMobileTarget()
		if target and target.Character then
			Camera.CFrame = Camera.CFrame:Lerp(
				CFrame.new(Camera.CFrame.Position, target.Character.HumanoidRootPart.Position),
				SMOOTH
			)
		end
	end
end)

AIMBtn.MouseButton1Click:Connect(function()
	AIM_ON = not AIM_ON
	AIMBtn.Text = "Aimbot: "..(AIM_ON and "ON" or "OFF")
end)

--==================================================
-- NOTIFY
--==================================================

pcall(function()
	game.StarterGui:SetCore("SendNotification",{
		Title="MH Prison Hub",
		Text="Loaded (Mobile Only)",
		Duration=4
	})
end)
